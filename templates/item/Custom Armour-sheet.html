<form class="{{cssClass}}" autocomplete="off">

    {{!-- Sheet Header --}}
    <header class="sheet-header">
        <img class="profile-img" src="{{item.img}}" data-edit="img" title="{{item.name}}"/>
        <div class="header-fields">
            <h1 class="charname"><input name="name" type="text" value="{{item.name}}" placeholder="Name"/></h1>
            <div class="equipmentDetails" id="equipmentDetails">
                <div id="qty" class="equipmentStat">
                    <label class="resource-label">Qty:</label>
                    <input type="number" name="data.quantity" value="{{data.data.quantity}}" data-dtype="Number"/>
                </div>
                <div id="tl" class="equipmentStat">
                    <label class="resource-label">TL:</label>
                    <input type="number" name="data.tl" value="{{data.data.tl}}" data-dtype="Number"/>
                </div>
                <div id="lc" class="equipmentStat">
                    <label class="resource-label">LC:</label>
                    <input type="number" name="data.lc" value="{{data.data.lc}}" data-dtype="Number"/>
                </div>
                <div id="equipped" class="flexrow">
                    <select name="data.equipStatus" class="equipStatusSelect">
                        {{#select data.data.equipStatus}}
                        <option value="equipped">Equipped</option>
                        <option value="carried">Carried</option>
                        <option value="notCarried">Not Carried</option>
                        {{/select}}
                    </select>
                </div>
                <div id="subCategory" class="flexrow">
                    <label class="resource-label" style="flex: 0.5;">Race / Meta Trait / Etc:</label>
                    <input type="text" style="flex: 1;" name="data.subCategory" value="{{data.data.subCategory}}" placeholder="Leave this blank if you don't want it categorized"/>
                </div>
                <div id="value" class="equipmentStatLong">
                    <label class="resource-label">Value:</label>
                    <label class="resource-label">{{data.data.cost}}$</label>
                    <label class="resource-label"> / {{data.data.ttlCost}}$ total</label>
                </div>
                <div id="weight" class="equipmentStatLong">
                    <label class="resource-label">Weight:</label>
                    <label class="resource-label">{{data.data.weight}}lbs</label>
                    <label class="resource-label"> / {{data.data.ttlWeight}}lbs total</label>
                </div>
            </div>
        </div>
    </header>
    <div style="padding-top: 2px;">
        <label class="resource-label" style="width: 32px;">Short Notes:</label>
        <input type="text" name="data.shortNotes" value="{{data.data.shortNotes}}" style="width: calc(100% - 78px);"/>
    </div>

    {{!-- Sheet Tab Navigation --}}
    <nav id="tabselect" class="sheet-tabs tabs" data-group="primary">
        <div class="header">
            <a class="item" data-tab="notes">Notes</a>
        </div>
        <div class="header">
            <a class="item" data-tab="setup">Setup</a>
        </div>
        {{#unless (eq data.data.armour.bodyType.name "") }}
        <div class="header">
            <a class="item" data-tab="design">Design</a>
        </div>
        <div class="header">
            <a class="item" data-tab="armour">Display</a>
        </div>
        {{/unless}}
    </nav>

    {{!-- Sheet Body --}}
    <section class="sheet-body">

        {{!-- Note Tab --}}
        <div class="tab stats" data-tab="notes" data-group="primary">
            <h3 class="bold">Detailed Notes</h3>
            <div class="tab">
                <textarea rows="8" name="data.notes">{{{data.data.notes}}}</textarea>
            </div>
        </div>

        {{!-- Armour Setup Tab --}}
        <div class="tab stats" data-tab="setup" data-group="primary">
            <div class="tab">
                <span>
                    <label>Body Type:</label>
                    <select name="data.armour.bodyType.name" class="bodyType">
                        {{#select data.data.armour.bodyType.name}}
                        <option value="">Make a Selection</option>
                        <option value="humanoid">Humanoid</option>
                        <option value="wingedHumanoid">Winged Humanoid</option>
                        <option value="quadruped">Quadruped</option>
                        <option value="wingedQuadruped">Winged Quadruped</option>
                        <option value="hexapod">Hexapod</option>
                        <option value="wingedHexapod">Winged Hexapod</option>
                        <option value="centaur">Centaur</option>
                        <option value="avian">Avian</option>
                        <option value="vermiform">Vermiform</option>
                        <option value="lamia">Lamia</option>
                        <option value="wingedLamia">Winged Lamia</option>
                        <option value="octopod">Octopod</option>
                        <option value="cancroid">Cancroid</option>
                        <option value="ichthyoid">Ichthyoid</option>
                        <option value="arachnoid">Arachnoid</option>
                        {{/select}}
                    </select>
                </span>
                {{#if (eq data.data.armour.bodyType.name "") }}
                <br>Select a body type for this custom armour.
                {{else}}
                <span class="tooltip">
                    <label>Layer:</label>
                    <input type="number" style="width: unset;" name="data.armour.layer" value="{{data.armour.layer}}" data-dtype="Number" />
                    <span class="tooltiptext">
                        <div>
                            Higher layer numbers are placed above lower layer numbers.<br>
                            -∞ is closest to the body.<br>
                            +∞ is furthest from the body.<br>
                            You can enter any real number.<br>
                            Ties won't cause errors but should be avoided.<br>
                        </div>
					</span>
                </span>
                {{/if}}
            </div>
        </div>

        {{!-- Armour Design Tab --}}
        <div class="tab stats" data-tab="design" data-group="primary">
            <div class="tab">
                {{#unless (eq data.data.armour.bodyType.name "") }}
                <div>
                    <div>
                        <h2 class="bold" style="text-align: center;">What The Fuck Is This Shit?</h2>
                        <div class="equipment-info-container">{{{data.data.info}}}</div>
                    </div>
                    <table>
                        <tr class="hit-locations">
                            <th class="question-container" id="armour-location" style="width: 100px;">
                                Location
                                <span class="small-question-button">
                                    <i class="fas fa-question"></i>
                                </span>
                            </th>
                            <th class="question-container" id="armour-sub-location" style="width: 100px;">
                                Sublocation
                                <span class="small-question-button">
                                    <i class="fas fa-question"></i>
                                </span>
                            </th>
                            <th class="question-container" id="armour-coverage" style="width: 80px;">
                                Coverage
                                <span class="small-question-button">
                                    <i class="fas fa-question"></i>
                                </span>
                            </th>
                            <th class="question-container" id="armour-voider" style="width: 50px;">
                                Voider?
                                <span class="small-question-button">
                                    <i class="fas fa-question"></i>
                                </span>
                            </th>
                            <th class="question-container" id="armour-material" style="width: 190px;">
                                Armour Material
                                <span class="small-question-button">
                                    <i class="fas fa-question"></i>
                                </span>
                            </th>
                            {{#if this.data.data.armourDesign.allowMagicalMaterialsForCustom}}
                            <th class="question-container" id="armour-material-essential" style="width: 60px;">
                                Essential
                                <span class="small-question-button">
                                    <i class="fas fa-question"></i>
                                </span>
                            </th>
                            {{/if}}
                            <th class="question-container" id="armour-construction" style="width: 135px;">
                                Construction
                                <span class="small-question-button">
                                    <i class="fas fa-question"></i>
                                </span>
                            </th>
                            <th class="question-container" id="armour-selectedDR" style="width: 85px;">
                                Selected DR
                                <span class="small-question-button">
                                    <i class="fas fa-question"></i>
                                </span>
                            </th>
                        </tr>
                        {{#each data.data.armour.bodyType.body as |bodyPart partId|}}<!--Loop through the body parts-->
                        {{#if bodyPart.subLocation}}<!--Check to see if there are sublocations and display them-->
                        {{#each bodyPart.subLocation as |subLocation locationId|}}<!--Loop through the sublocations-->
                        {{#if subLocation.surfaceArea}}
                        {{#showVoider bodyPart subLocation}}
                        <tr class="hit-locations">
                            <td>
                                {{bodyPart.label}}
                            </td>
                            <td>
                                {{subLocation.label}}
                            </td>
                            <td>
                                {{round subLocation.surfaceArea 100}}
                            </td>
                            <td>
                                {{subLocation.voider}}
                            </td>
                            <td>
                                <select name="data.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}.material.name">
                                {{#select subLocation.material.name}}
                                {{#each ../../data.data.armourDesign.materials as |material id|}}
                                {{#ifCond ../../../data.data.tl '>=' material.tl}}
                                <option value="{{material.name}}">{{material.name}}</option>
                                {{/ifCond}}
                                {{/each}}
                                {{/select}}
                                </select>
                            </td>
                            {{#if ../../this.data.data.armourDesign.allowMagicalMaterialsForCustom}}
                            <td>
                                <input type="checkbox" name="data.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}.material.essential" {{checked subLocation.material.essential}} data-dtype="Boolean" style="width: 100%;"/>
                            </td>
                            {{/if}}
                            <td>
                                <select name="data.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}.construction.name">
                                    {{#select subLocation.construction.name}}
                                    {{#each ../../data.data.armourDesign.constructionTypes as |construction id|}}
                                    {{#armourConstructionLimit ../../../data.data.tl construction subLocation bodyPart}}
                                    <option value="{{construction.name}}">{{construction.name}}</option>
                                    {{/armourConstructionLimit}}
                                    {{/each}}
                                    {{/select}}
                                </select>
                            </td>
                            <td style="{{{valueInRangeStyle subLocation.construction.minDR subLocation.selectedDR subLocation.material.maxDR}}}" class="custom-armour-selected-dr">
                                {{subLocation.construction.minDR}} / <input type="number" name="data.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}.selectedDR" value="{{subLocation.selectedDR}}" data-dtype="Number" style="width: 30px;"/> / {{subLocation.material.maxDR}}
                            </td>
                        </tr>
                        {{/showVoider}}
                        {{/if}}
                        {{/each}}
                        {{else}}<!--Display details for parts without sublocations (Pretty much only the skull and brian)-->
                        <tr class="hit-locations">
                            <td colspan="2">{{bodyPart.label}}</td>
                            <td>
                                {{round bodyPart.surfaceArea 100}}
                            </td>
                            <td></td>
                            <td>
                                <select name="data.armour.bodyType.body.{{partId}}.material.name">
                                    {{#select bodyPart.material.name}}
                                    {{#each ../data.data.armourDesign.materials as |material id|}}
                                    {{#ifCond ../../data.data.tl '>=' material.tl}}
                                    <option value="{{material.name}}">{{material.name}}</option>
                                    {{/ifCond}}
                                    {{/each}}
                                    {{/select}}
                                </select>
                            </td>
                            {{#if ../this.data.data.armourDesign.allowMagicalMaterialsForCustom}}
                            <td>
                                <input type="checkbox" name="data.armour.bodyType.body.{{partId}}.material.essential" {{checked bodyPart.material.essential}} data-dtype="Boolean" style="width: 100%;"/>
                            </td>
                            {{/if}}
                            <td>
                                <select name="data.armour.bodyType.body.{{partId}}.construction.name">
                                    {{#select bodyPart.construction.name}}
                                    {{#each ../data.data.armourDesign.constructionTypes as |construction id|}}
                                    {{#armourConstructionLimit ../../data.data.tl construction bodyPart bodyPart}}
                                    <option value="{{construction.name}}">{{construction.name}}</option>
                                    {{/armourConstructionLimit}}
                                    {{/each}}
                                    {{/select}}
                                </select>
                            </td>
                            <td style="{{{valueInRangeStyle bodyPart.construction.minDR bodyPart.selectedDR bodyPart.material.maxDR}}}" class="custom-armour-selected-dr">
                                {{bodyPart.construction.minDR}} / <input type="number" name="data.armour.bodyType.body.{{partId}}.selectedDR" value="{{bodyPart.selectedDR}}" data-dtype="Number" style="width: 30px;"/> / {{bodyPart.material.maxDR}}
                            </td>
                        </tr>
                        {{/if}}
                        {{/each}}
                    </table>
                </div>
                {{/unless}}
            </div>
        </div>

        {{!-- Armour Display Tab --}}
        <div class="tab stats" data-tab="armour" data-group="primary">
            <div class="tab">
                <table class="dr-entry-table">
                    {{#unless (eq data.data.armour.bodyType.name "") }}
                        <tr class="hit-locations">
                            <td class="dr-header"></td>
                            <td class="dr-header">Flex</td>
                            <td class="dr-damage-types">Hardness</td>
                            <td class="dr-damage-types">Burn</td>
                            <td class="dr-damage-types">Cor</td>
                            <td class="dr-damage-types">Cr</td>
                            <td class="dr-damage-types">Cut</td>
                            <td class="dr-damage-types">Fat</td>
                            <td class="dr-damage-types">Imp</td>
                            <td class="dr-damage-types">Pi</td>
                            <td class="dr-damage-types">Tox</td>
                        </tr>
                    {{/unless}}
                    {{#each data.data.armour.bodyType.body as |bodyPart partId|}}<!--Loop through the body parts-->
                    <tr class="hit-locations master-location">
                        <th colspan="11">
                            <div>{{bodyPart.label}}</div>
                        </th>
                    </tr>
                    {{#if bodyPart.subLocation}}<!--Check to see if there are sublocations and display them-->
                    {{#each bodyPart.subLocation as |subLocation locationId|}}<!--Loop through the sublocations-->
                    <tr class="hit-locations">
                        <td class="dr-row">
                            <div>{{subLocation.label}}</div>
                        </td>
                        <td class="dr-row">
                            {{subLocation.flexible}}
                        </td>
                        <td class="dr-row">
                            {{subLocation.drHardening}}
                        </td>
                        <td class="dr-row">
                            {{subLocation.drBurn}}
                        </td>
                        <td class="dr-row">
                            {{subLocation.drCor}}
                        </td>
                        <td class="dr-row">
                            {{subLocation.drCr}}
                        </td>
                        <td class="dr-row">
                            {{subLocation.drCut}}
                        </td>
                        <td class="dr-row">
                            {{subLocation.drFat}}
                        </td>
                        <td class="dr-row">
                            {{subLocation.drImp}}
                        </td>
                        <td class="dr-row">
                            {{subLocation.drPi}}
                        </td>
                        <td class="dr-row">
                            {{subLocation.drTox}}
                        </td>
                    </tr>
                    {{/each}}
                    {{else}}<!--Display details for parts without sublocations (Pretty much only the skull and brian)-->
                    <tr class="hit-locations">
                        <td class="dr-row">{{bodyPart.label}}</td>
                        <td class="dr-row">
                            {{bodyPart.flexible}}
                        </td>
                        <td class="dr-row">
                            {{bodyPart.drHardening}}
                        </td>
                        <td class="dr-row">
                            {{bodyPart.drBurn}}
                        </td>
                        <td class="dr-row">
                            {{bodyPart.drCor}}
                        </td>
                        <td class="dr-row">
                            {{bodyPart.drCr}}
                        </td>
                        <td class="dr-row">
                            {{bodyPart.drCut}}
                        </td>
                        <td class="dr-row">
                            {{bodyPart.drFat}}
                        </td>
                        <td class="dr-row">
                            {{bodyPart.drImp}}
                        </td>
                        <td class="dr-row">
                            {{bodyPart.drPi}}
                        </td>
                        <td class="dr-row">
                            {{bodyPart.drTox}}
                        </td>
                    </tr>
                    {{/if}}
                    {{/each}}
                </table>
            </div>
        </div>
    </section>
</form>
