<form class="{{cssClass}}" autocomplete="off">

    {{!-- Sheet Header --}}
    <header class="sheet-header">
        <img class="profile-img" src="{{item.img}}" data-edit="img" title="{{item.name}}"/>
        <div class="header-fields">
            <h1 class="charname">
                <input name="name" type="text" value="{{item.name}}" placeholder="Name"/>
            </h1>
        </div>
    </header>
    <div style="padding-top: 2px;">
        <table class="consolidated-item-sheet-header">{{!-- Rows in this table have a total colspan of 5 --}}
            {{#if (eq item.type "Equipment")}}{{!-- Only Equipment gets qty, value, weight, lc, and equip status --}}
            <tr>
                <td>
                    <div style="display: grid; grid-template-columns: auto auto;">
                        <label class="resource-label">Qty:</label>
                        <input type="number" name="system.quantity" value="{{item.system.quantity}}" data-dtype="Number"/>
                    </div>
                </td>
                <td>
                    <div style="display: grid; grid-template-columns: auto auto auto;">
                        <label class="resource-label">Value:</label>
                        <input type="number" name="system.cost" value="{{item.system.cost}}" data-dtype="Number"/>
                        <label class="resource-label"> / {{item.system.ttlCost}}$ total</label>
                    </div>
                </td>
                <td>
                    <div style="display: grid; grid-template-columns: auto auto auto;">
                        <label class="resource-label">Weight:</label>
                        <input type="number" name="system.weight" value="{{item.system.weight}}" data-dtype="Number"/>
                        <label class="resource-label"> / {{item.system.ttlWeight}}lb{{checkPlural item.system.ttlWeight}} total</label>
                    </div>
                </td>
                <td>
                    <div style="display: grid; grid-template-columns: auto auto;">
                        <label class="resource-label">LC:</label>
                        <input type="number" name="system.lc" value="{{item.system.lc}}" data-dtype="Number"/>
                    </div>
                </td>
                <td>
                    <div style="display: grid; grid-template-columns: auto;">
                        <select name="system.equipStatus" class="equipStatusSelect">
                            {{selectOptions equipStatusOptions selected=item.system.equipStatus}}
                        </select>
                    </div>
                </td>
            </tr>
            {{/if}}
            <tr>
                {{#if (or (eq item.type "Equipment") (eq item.type "Rollable"))}}{{!-- Only rollables and equipment get a TL --}}
                <td>
                    <div style="display: grid; grid-template-columns: auto auto;">
                        <label class="resource-label">TL:</label>
                        <input type="number" name="system.tl" value="{{item.system.tl}}" data-dtype="Number"/>
                    </div>
                </td>
                {{/if}}
                <td colspan="4">
                    <div style="display: grid; grid-template-columns: 130px auto;">
                        <label class="resource-label">Race / Meta Trait / Etc:</label>
                        <input type="text" name="system.subCategory" value="{{item.system.subCategory}}" placeholder="Leave this blank if you don't want it categorized"/>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="5">
                    <div style="display: grid; grid-template-columns: 76px auto;">
                        <label class="resource-label">Short Notes:</label>
                        <input type="text" name="system.shortNotes" value="{{item.system.shortNotes}}"/>
                    </div>
                </td>
            </tr>
        </table>
    </div>

    {{#if (eq item.type "Trait")}}
    <div>
        <table>
            <tr>
                <td>
                    Category
                </td>
                <td>
                    <select name="system.category">
                        {{selectOptions traitTypeOptions selected=item.system.category}}
                    </select>
                </td>
            </tr>
            <tr>
                <td>
                    Roll (If Applicable)
                </td>
                <td>
                    <input type="text" name="system.level" value="{{item.system.level}}" data-dtype="Number"/>
                </td>
            </tr>
            <tr>
                <td>
                    Base Points
                </td>
                <td>
                    <input type="text" name="system.levelledPoints.basePoints" value="{{item.system.levelledPoints.basePoints}}" placeholder="0" data-dtype="Number"/>
                </td>
            </tr>
            <tr>
                <td>
                    Levels
                </td>
                <td>
                    <input type="text" name="system.levelledPoints.levels" value="{{item.system.levelledPoints.levels}}" placeholder="0" data-dtype="Number"/>
                </td>
            </tr>
            <tr>
                <td>
                    Cost Per Level
                </td>
                <td>
                    <input type="text" name="system.levelledPoints.pointsPerLevel" value="{{item.system.levelledPoints.pointsPerLevel}}" placeholder="0" data-dtype="Number"/>
                </td>
            </tr>
            <tr>
                <td>
                    Net Modifier
                </td>
                <td>
                    <input type="number" name="system.levelledPoints.netModifier" value="{{item.system.levelledPoints.netModifier}}" placeholder="100" data-dtype="Number"/>
                </td>
            </tr>
            <tr>
                <td>
                    Multiplier (Like for Alternative Abilities, or Character Point Powered Abilities).
                </td>
                <td>
                    <input type="text" name="system.levelledPoints.totalMultipliers" value="{{item.system.levelledPoints.totalMultipliers}}" placeholder="1" data-dtype="Number"/>
                </td>
            </tr>
            <tr>
                <td>
                    Total Point Cost
                </td>
                <td style="font-weight: bold; text-align: center">
                    {{item.system.levelledPoints.totalPoints}}
                </td>
            </tr>
        </table>
    </div>
    {{else if (eq item.type "Rollable")}}
    <div class="header-fields">
        <table>
            <tr>
                <td>
                    <label class="resource-label">Category</label>
                </td>
                <td>
                    <select name="system.category">
                        {{selectOptions rollableTypeOptions selected=item.system.category}}
                    </select>
                </td>
            </tr>
            {{#if (eq item.system.category "skill") }}
            <tr>
                <td>
                    <label class="resource-label">Skill Difficulty</label>
                </td>
                <td>
                    <select name="system.difficulty">
                        {{selectOptions rollableDifficultyOptions selected=item.system.difficulty}}
                    </select>
                </td>
            </tr>
            {{else}}
            <tr>
                <td>
                    <label class="resource-label">Technique Difficulty</label>
                </td>
                <td>
                    <select name="system.difficulty">
                        {{selectOptions techniqueDifficultyOptions selected=item.system.difficulty}}
                    </select>
                </td>
            </tr>
            {{/if}}

            {{#if (eq item.system.category "skill") }}
            <tr>
                <td>
                    <label class="resource-label">Base Attribute</label>
                </td>
                <td>
                    <select name="system.baseAttr">
                        {{selectOptions baseAttrOptions selected=item.system.baseAttr}}
                    </select>
                </td>
            </tr>
            <tr>
                <td>
                    <label class="resource-label">Do you have Weapon Master covering this skill?</label>
                </td>
                <td style="display: flex">
                    <input type="checkbox" name="system.weaponMaster" {{checked item.system.weaponMaster}} data-dtype="Boolean"/>
                </td>
            </tr>
            {{else}}
            <tr>
                <td>
                    <label class="resource-label">Is this technique half price?</label>
                </td>
                <td style="display: flex">
                    <input type="checkbox" name="system.halfPriceTechnique" {{checked item.system.halfPriceTechnique}} data-dtype="Boolean"/>
                </td>
            </tr>
            <tr>
                <td>
                    <label class="resource-label">Is this technique based on an active defence</label>
                </td>
                <td>
                    <select name="system.defenceTechnique">
                        {{selectOptions defenceTypeOptions selected=item.system.defenceTechnique}}
                    </select>
                </td>
            </tr>
            {{#if (or (eq item.system.defenceTechnique "block") (eq item.system.defenceTechnique "parry"))}}
            <tr>
                <td>
                    {{#if (eq item.system.defenceTechnique "parry")}}
                    <label class="resource-label">The Parry's underlying modifier, like the +2 for a staff</label>
                    {{else}}
                    <label class="resource-label">The Block's underlying modifier, like the +3 for a large shield</label>
                    {{/if}}
                </td>
                <td>
                    <input type="text" name="system.defenceTechniqueMod" value="{{item.system.defenceTechniqueMod}}" data-dtype="Number"/>
                </td>
            </tr>
            {{/if}}
            <tr>
                <td>
                    <label id="baseSkillLabel" class="resource-label">Base Skill</label>
                </td>
                {{#unless (eq item.system.defenceTechnique "dodge")}}
                <td style="display: flex">
                    <input id="baseSkillText" type="text" name="system.baseSkill" value="{{item.system.baseSkill}}" data-dtype="String" style="flex:3;"/>
                    <label id="baseSkillLevel" style="flex: 1; text-align: center; line-height: 18px; font-weight: bold;">{{item.system.baseSkillLevel}}</label>
                </td>
                {{else}}
                <td style="display: flex">
                    <label style="flex: 1; text-align: right; line-height: 18px; padding-right: 0.5em; text-decoration: underline">Dodge: </label>
                    <label id="baseSkillLevel" style="flex: 1; text-align: left; line-height: 18px; font-weight: bold;">{{item.system.baseSkillLevel}}</label>
                </td>
                {{/unless}}
            </tr>
            <tr>
                <td>
                    <label class="resource-label">Base Penalty</label>
                </td>
                <td>
                    <input type="text" name="system.minLevel" value="{{item.system.minLevel}}" data-dtype="Number"/>
                </td>
            </tr>
            <tr>
                <td>
                    <label class="resource-label">Max Bonus</label>
                </td>
                <td>
                    <input type="text" name="system.maxLevel" value="{{item.system.maxLevel}}" data-dtype="Number"/>
                </td>
            </tr>
            {{/if}}

            <tr>
                <td>
                    <label class="resource-label">Modifier</label>
                </td>
                <td>
                    <input type="text" name="system.mod" value="{{item.system.mod}}" data-dtype="Number"/>
                </td>
            </tr>
            <tr>
                <td>
                    <label class="resource-label">Level</label>
                </td>
                <td>
                    <label style="text-align: center; line-height: 18px; font-weight: bold; display: block;">{{item.system.level}}</label>
                </td>
            </tr>
            <tr>
                <td>
                    <label class="resource-label">Points</label>
                </td>
                <td>
                    <input type="text" name="system.points" value="{{item.system.points}}" data-dtype="Number"/>
                </td>
            </tr>
        </table>
    </div>
    {{else if (eq item.type "Spell")}}
    <table class="">
        <tr>
            <td class="tooltip">
                Spell Class
                <span class="tooltiptext" style="margin-left: -100px; bottom: 75%">
                            <span style="font-weight: bold;">Blocking</span> - Blocking spells that are used against or on other targets, such as Fumble, or Blocking spells that modify the attack or your defence, such as Bladeturning, Block, or Boost Attribute, should be entered as Regular spells.  <br>
                        </span>
            </td>
            <td>
                <select name="system.spellClass">
                    {{selectOptions spellClass selected=item.system.spellClass}}
                </select>
            </td>
        </tr>
        {{#if (eq item.system.spellClass "Blocking") }}
        <tr>
            <td class="tooltip">
                Defence Type
                <span class="tooltiptext" style="margin-left: -200px">
                            Blocking spells that count as another type of active defence are typically subject to Deceptive Attacks, Ripostes, Runaround Attacks, Etc.<br><br>
                            Magical defences like Phase and Blink are not.
                        </span>
            </td>
            <td>
                <select name="system.defenceType">
                    {{selectOptions defenceTypeOptions selected=item.system.defenceType}}
                </select>
            </td>
        </tr>
        <tr>
            <td class="tooltip">
                Attacks Stopped
                <span class="tooltiptext" style="margin-left: -200px">
                            <span style="font-weight: bold;">All</span> - A success stops all incoming projectiles. (Such as Phase, Blink, etc)<br>
                            <span style="font-weight: bold;">Single</span> - A success stops exactly one incoming attack. (Such as Return Missile)<br>
                            <span style="font-weight: bold;">Regular</span> - A sucess stops a number of attacks equal to the margin of success plus one, as usual. (Like a normal non-magical Dodge)<br>
                        </span>
            </td>
            <td>
                <select name="system.defenceQty">
                    {{selectOptions defenceQty selected=item.system.defenceQty}}
                </select>
            </td>
        </tr>
        {{/if}}
        <tr>
            <td>Difficulty</td>
            <td>
                <select name="system.difficulty">
                    {{selectOptions rollableDifficultyOptions selected=item.system.difficulty}}
                </select>
            </td>
        </tr>
        <tr>
            <td class="tooltip">
                Magical Ability
                <span class="tooltiptext" style="margin-left: -200px">
                            Your base magical ability. IQ plus Magery, IQ plus Clerical Investment, whatever the value is for your specific form of magic.
                        </span>
            </td>
            <td>{{item.system.magicalAbility}}</td>
        </tr>
        <tr>
            <td class="tooltip">
                Modifier
                <span class="tooltiptext" style="margin-left: -200px">
                            A spell specific modifier. This is not your Magery or Clerical Investment.
                        </span>
            </td>
            <td><input type="text" name="system.mod" value="{{item.system.mod}}" data-dtype="Number"/></td>
        </tr>
        <tr>
            <td>Level</td>
            <td>{{item.system.level}}</td>
        </tr>
        <tr>
            <td>Points</td>
            <td><input type="text" name="system.points" value="{{item.system.points}}" data-dtype="Number"/></td>
        </tr>
        <tr id="college">
            <td>College</td>
            <td><input type="text" name="system.college" value="{{item.system.college}}" placeholder="This costs ten times as much for characters in the USA"/></td>
        </tr>
        <tr>
            <td>Base Cost</td>
            <td><input type="number" name="system.spellDetails.baseCost" value="{{item.system.spellDetails.baseCost}}" placeholder="The casting cost of the spell" data-dtype="Number"/></td>
        </tr>
        <tr>
            <td>Levelled Cost</td>
            <td><input type="number" name="system.spellDetails.levelledCost" value="{{item.system.spellDetails.levelledCost}}" placeholder="The casting cost of the spell" data-dtype="Number"/></td>
        </tr>
        <tr>
            <td>Base Time to Cast</td>
            <td><input type="text" name="system.spellDetails.timeToCast" value="{{item.system.spellDetails.timeToCast}}" placeholder="The time it takes to cast the spell"/></td>
        </tr>
        <tr>
            <td>Duration</td>
            <td><input type="text" name="system.spellDetails.duration" value="{{item.system.spellDetails.duration}}" placeholder="The duration of the spell"/></td>
        </tr>
        <tr>
            <td>Prerequisites</td>
            <td><input type="text" name="system.spellDetails.prerequisites" value="{{item.system.spellDetails.prerequisites}}" placeholder="Prerequisites to learn the spell"/></td>
        </tr>
        <tr>
            <td>Page Reference</td>
            <td><input type="text" name="system.pageRef" value="{{item.system.pageRef}}"/></td>
        </tr>
    </table>
    {{else if (eq item.type "Equipment")}}

    {{else if (eq item.type "Ritual")}}
    <div class="header-fields">
        <table style="margin: unset; padding: unset; background: unset; border: unset;">
            <tr>
                <td style="width: 50%; vertical-align:top"><!-- Left Col -->
                    <table style="background: #00ffff47">
                        <tr>
                            <th colspan="2" style="font-size: larger">Ritual Details</th>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Ritual Type:</label>
                            </td>
                            <td>
                                <select name="system.ritualType">
                                    {{selectOptions ritualTypes selected=item.system.ritualType}}
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Ritual Mastery:</label>
                            </td>
                            <td>
                                <input id="rpmStats" type="checkbox" name="system.ritualMastery" {{checked item.system.ritualMastery}} data-dtype="Boolean"/>
                            </td>
                        </tr>
                        {{#if item.system.higherPurpose1Present}}
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Higher Purpose ({{item.system.higherPurpose1Name}}) applies for a +{{item.system.higherPurpose1Level}} bonus</label>
                            </td>
                            <td>
                                <input id="hp1" type="checkbox" name="system.higherPurpose1Applies" {{checked item.system.higherPurpose1Applies}} data-dtype="Boolean"/>
                            </td>
                        </tr>
                        {{/if}}
                        {{#if item.system.higherPurpose2Present}}
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Higher Purpose ({{item.system.higherPurpose2Name}}) applies for a +{{item.system.higherPurpose2Level}} bonus</label>
                            </td>
                            <td>
                                <input id="hp2" type="checkbox" name="system.higherPurpose2Applies" {{checked item.system.higherPurpose2Applies}} data-dtype="Boolean"/>
                            </td>
                        </tr>
                        {{/if}}
                        {{#if item.system.higherPurpose3Present}}
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Higher Purpose ({{item.system.higherPurpose3Name}}) applies for a +{{item.system.higherPurpose3Level}} bonus</label>
                            </td>
                            <td>
                                <input id="hp3" type="checkbox" name="system.higherPurpose3Applies" {{checked item.system.higherPurpose3Applies}} data-dtype="Boolean"/>
                            </td>
                        </tr>
                        {{/if}}
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Grimoire Bonus</label>
                            </td>
                            <td>
                                <input type="number" style="width: 50%" name="system.grimBonus" value="{{item.system.grimBonus}}" data-dtype="Number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Level</label>
                            </td>
                            <td>
                                {{item.system.level}}
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Energy Cost</label>
                            </td>
                            <td>
                                {{item.system.energyCost}}
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Number Ready</label>
                            </td>
                            <td>
                                <input type="number" style="width: 50%" name="system.quantity" value="{{item.system.quantity}}" data-dtype="Number" />
                            </td>
                        </tr>
                    </table>
                </td>
                <td style="width: 50%; vertical-align:top"><!-- Right Col -->
                    {{#if (or (eq item.system.ritualType "charm") (eq item.system.ritualType "conditionalCharm") (eq item.system.ritualType "conditional"))}}
                    <table style="background: rgba(255,102,0,0.28)">
                        <tr>
                            {{#if (eq item.system.ritualType "conditional")}}
                            <th colspan="2" style="font-size: larger">Conditional Ritual Details</th>
                            {{/if}}
                            {{#if (eq item.system.ritualType "conditionalCharm")}}
                            <th colspan="2" style="font-size: larger">Conditional Charm Details</th>
                            {{/if}}
                            {{#if (eq item.system.ritualType "charm")}}
                            <th colspan="2" style="font-size: larger">Charm Details</th>
                            {{/if}}
                        </tr>
                        {{#unless (eq item.system.ritualType "conditional")}}
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Workspace Modifier: </label>
                                <input type="number" style="width: 50%" name="system.workspaceMod" value="{{item.system.workspaceMod}}" data-dtype="Number" />
                            </td>
                        </tr>
                        {{/unless}}
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Safe Threshold: </label>
                                {{item.system.safeThreshold}}
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Character's Mana Contribution: </label>
                                {{item.system.actorContribution}}
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Additional Sources Of Mana: </label>
                                <input type="number" style="width: 50%" name="system.additionalSourcesOfMana" value="{{item.system.additionalSourcesOfMana}}" data-dtype="Number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Total Safe Threshold: </label>
                                {{item.system.totalSafeThreshold}}
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Crafting Roll Modifier (Higher numbers are bad): </label>
                                {{item.system.craftingRollMod}} <input type='button' class='makeCraftingRoll' id="{{item.name}}" value='Make Crafting Roll'/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Quirk Roll Modifier (Higher numbers are good): </label>
                                {{item.system.quirkRollMod}} <input type='button' class='makeQuirkRoll' id="{{item.name}}"  value='Make Quirk Roll'/>
                            </td>
                        </tr>
                    </table>
                    {{/if}}

                    {{#if (eq item.system.ritualType "elixir") }}
                    <table style="background: rgba(0,255,21,0.28)">
                        <tr>
                            <th colspan="2" style="font-size: larger">Elixir Details</th>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Workspace Modifier</label>
                                <input type="number" style="width: 50%" name="system.workspaceMod" value="{{item.system.workspaceMod}}" data-dtype="Number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Elixir Type</label>
                                <select name="system.elixir.type">
                                    {{selectOptions elixirTypes selected=item.system.elixirType}}
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Safe Threshold: </label>
                                {{item.system.safeThreshold}}
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Character's Mana Contribution: </label>
                                {{item.system.actorContribution}}
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Additional Sources Of Mana: </label>
                                <input type="number" style="width: 50%" name="system.additionalSourcesOfMana" value="{{item.system.additionalSourcesOfMana}}" data-dtype="Number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Total Safe Threshold: </label>
                                {{item.system.totalSafeThreshold}}
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Crafting Roll Modifier (Higher numbers are bad): </label>
                                {{item.system.craftingRollMod}} <input type='button' class='makeCraftingRoll' id="{{item.name}}" value='Make Crafting Roll'/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Quirk Roll Modifier (Higher numbers are good): </label>
                                {{item.system.quirkRollMod}} <input type='button' class='makeQuirkRoll' id="{{item.name}}"  value='Make Quirk Roll'/>
                            </td>
                        </tr>
                    </table>
                    <table style="background: rgba(0,255,21,0.28)">
                        <tr>
                            <th colspan="4" style="font-size: larger; text-decoration: underline;">Alchemy Ingredients</th>
                        </tr>
                        <tr>
                            <th style="width: 66px;">Rarity</th>
                            <th>Quantity</th>
                            <th>Cost</th>
                            <th>Weight</th>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Improvised</label>
                            </td>
                            <td>
                                <input type="number" style="width: 100%" name="system.elixir.ingredientQtys.improvised" value="{{item.system.elixir.ingredientQtys.improvised}}" data-dtype="Number" />
                            </td>
                            <td style="text-align: center">
                                {{item.system.elixir.ingredientQtys.improvised$}} $
                            </td>
                            <td style="text-align: center">
                                {{item.system.elixir.ingredientQtys.improvisedLb}} lbs
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Basic</label>
                            </td>
                            <td>
                                <input type="number" style="width: 100%" name="system.elixir.ingredientQtys.basic" value="{{item.system.elixir.ingredientQtys.basic}}" data-dtype="Number" />
                            </td>
                            <td style="text-align: center">
                                {{item.system.elixir.ingredientQtys.basic$}} $
                            </td>
                            <td style="text-align: center">
                                {{item.system.elixir.ingredientQtys.basicLb}} lbs
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Good</label>
                            </td>
                            <td>
                                <input type="number" style="width: 100%" name="system.elixir.ingredientQtys.good" value="{{item.system.elixir.ingredientQtys.good}}" data-dtype="Number" />
                            </td>
                            <td style="text-align: center">
                                {{item.system.elixir.ingredientQtys.good$}} $
                            </td>
                            <td style="text-align: center">
                                {{item.system.elixir.ingredientQtys.goodLb}} lbs
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Fine</label>
                            </td>
                            <td>
                                <input type="number" style="width: 100%" name="system.elixir.ingredientQtys.fine" value="{{item.system.elixir.ingredientQtys.fine}}" data-dtype="Number" />
                            </td>
                            <td style="text-align: center">
                                {{item.system.elixir.ingredientQtys.fine$}} $
                            </td>
                            <td style="text-align: center">
                                {{item.system.elixir.ingredientQtys.fineLb}} lbs
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Legendary</label>
                            </td>
                            <td style="text-align: center">
                                <input type="number" style="width: 100%" name="system.elixir.ingredientQtys.legendary" value="{{item.system.elixir.ingredientQtys.legendary}}" data-dtype="Number" />
                            </td>
                            <td>
                                <input type="number" style="width: 50%" name="system.elixir.ingredientQtys.legendary$" value="{{item.system.elixir.ingredientQtys.legendary$}}" data-dtype="Number" />
                                $ each
                            </td>
                            <td>
                                <input type="number" style="width: 50%" name="system.elixir.ingredientQtys.legendaryLb" value="{{item.system.elixir.ingredientQtys.legendaryLb}}" data-dtype="Number" />
                                lbs each
                            </td>
                        </tr>
                        <tr>
                            <th>
                                <label class="resource-label" style="flex: 0.5;">Total</label>
                            </th>
                            <th>
                                {{item.system.elixir.ingredientQtys.total}}
                            </th>
                            <th>
                                {{item.system.elixir.ingredientQtys.total$}} $
                            </th>
                            <th>
                                {{item.system.elixir.ingredientQtys.totalLb}} lbs
                            </th>
                        </tr>
                        <tr>
                            <td colspan="2" style="text-align: right">
                                <label class="resource-label" style="flex: 0.5;">Total Discount:</label>
                            </td>
                            <td style="text-align: center">
                                {{item.system.elixir.discount}} %
                            </td>
                            <td style="text-align: center">
                                {{item.system.elixir.discountManaValue}} energy
                            </td>
                        </tr>
                    </table>
                    {{/if}}

                    <table style="background: rgb(215,172,17,0.28)">
                        <tr>
                            <th colspan="4" style="font-size: larger; text-decoration: underline;">Economics</th>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Charm Availability</label>
                                <select name="system.charm.availability">
                                    {{selectOptions charmAvailability selected=item.system.availability}}
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="resource-label" style="flex: 0.5;">Sale / Purchase Cost:</label>
                                {{item.system.charm.saleCost}} $
                            </td>
                        </tr>
                    </table>

                </td>
            </tr>
        </table>

        {{!-- Energy Gathering --}}
        <table style="background: #7900ff47">
            <tr>
                <th colspan="4" style="font-size: larger">Energy Gathering</th>
            </tr>
            <tr>
                <td style="text-align: right; padding-right: 1em;">
                    {{#if (eq item.system.ritualAdeptTime 0) }}
                    Minutes per attempt
                    {{/if}}
                    {{#if (eq item.system.ritualAdeptTime 1) }}
                    Seconds for first attempt, minutes per subsequent attempts
                    {{/if}}
                    {{#if (eq item.system.ritualAdeptTime 2) }}
                    Seconds per attempt
                    {{/if}}
                </td>
                <td>
                    <input type="number" style="width: 50%" name="system.timeUnitsPerAttempt" value="{{item.system.timeUnitsPerAttempt}}" data-dtype="Number" />
                </td>
                <td style="text-align: right; padding-right: 1em;">
                    Gathering Modifier
                </td>
                <td>
                    <input type="number" style="width: 50%" name="system.gatherMod" value="{{item.system.gatherMod}}" data-dtype="Number" />
                </td>
            </tr>
            <tr>
                <td style="text-align: right; padding-right: 1em;">
                    Use personal mana reserve
                </td>
                <td>
                    <input id="usePersonalMana" type="checkbox" name="system.usePersonalMana" {{checked item.system.usePersonalMana}} data-dtype="Boolean"/>
                </td>
                <td style="text-align: right; padding-right: 1em;">
                    Extra mana from other sources
                </td>
                <td>
                    <input type="number" style="width: 50%" name="system.extraMana" value="{{item.system.extraMana}}" data-dtype="Number" />
                </td>
            </tr>
            <tr>
                <td colspan="4">
                    <input type='button' class='gatherEnergy' id="{{item.name}}" value='Gather Energy' style="width: 100%; height: 30px; font-weight: bold;"/>
                </td>
            </tr>
        </table>

        {{!-- Paths --}}
        <table style="background: #ed143d47;">
            <tr>
                <th colspan="7" style="font-size: larger">Path Details</th>
            </tr>
            <tr>
                <td style="width: 70px;">Level</td>
                <td style="width: 90px;">Effect</td>
                <td style="width: 95px;">Path</td>
                <td style="width: 35px; text-align: center">Cost</td>
                <td style="width: 37px; text-align: center">Skill</td>
                <td>Notes</td>
                <td style="width: 65px;"><h3 class="addPathRow" style="text-align: right;">Add Path</h3></td>
            </tr>
            {{#each item.system.path as |path id|}}
            <tr>
                <td>
                    <select name="system.path.{{id}}.level">
                        {{selectOptions ../pathLevel selected=path.level}}
                    </select>
                </td>
                <td>
                    <select name="system.path.{{id}}.effect">
                        {{selectOptions ../pathEffect selected=path.effect}}
                    </select>
                </td>
                <td>
                    <select name="system.path.{{id}}.path">
                        {{selectOptions ../paths selected=path.path}}
                    </select>
                </td>
                <td style="text-align: center">{{path.cost}}</td>
                <td style="text-align: center">{{path.skill}}</td>
                <td>
                    <input type="text" placeholder="Notes" name="system.path.{{id}}.notes" value="{{path.notes}}" title="{{path.notes}}" style="text-align:left; margin: unset" data-dtype="String"/>
                </td>
                <td  style="text-align: right;"><a class="path-delete" id="pathhh{{id}}" title="Delete Item"><i class="fas fa-trash"></i></a></td>
            </tr>
            {{/each}}
        </table>

        {{!-- Ritual Modifiers --}}
        <table style="background: rgba(190,237,20,0.28);">
            <tr>
                <th colspan="5" style="font-size: larger">Modifier Details</th>
            </tr>
            <tr>
                <td style="width: 143px;">Modifier</td>
                <td>Effect</td>
                <td style="width: 35px; text-align: center">Cost</td>
                <td>Notes</td>
                <td style="width: 130px;"><h3 class="addRitualModifierRow" style="text-align: right;">Add Ritual Modifier</h3></td>
            </tr>
            {{#each item.system.ritualModifier as |ritualModifier id|}}
            <tr>
                <td>
                    <select name="system.ritualModifier.{{id}}.modifier">
                        {{selectOptions ../ritualModifiers selected=ritualModifier.modifier}}
                    </select>
                </td>
                <td>
                    {{#if (eq ritualModifier.modifier "affliction") }}
                    <input type="number" name="system.ritualModifier.{{id}}.effect.percentage" value="{{ritualModifier.effect.percentage}}" style="text-align:center; width: 90%; margin: unset" min="0" step="5"/>
                    {{/if}}

                    {{#if (eq ritualModifier.modifier "trait") }}
                    <input type="number" name="system.ritualModifier.{{id}}.effect.level" value="{{ritualModifier.effect.level}}" style="text-align:center; width: 90%; margin: unset" />
                    {{/if}}

                    {{#if (eq ritualModifier.modifier "aoe") }}
                    <input type="number" name="system.ritualModifier.{{id}}.effect.area" value="{{ritualModifier.effect.area}}" style="text-align:center; width: 20%; margin-left: 1em;" /> yards
                    <input type="number" name="system.ritualModifier.{{id}}.effect.excludes" value="{{ritualModifier.effect.excludes}}" style="text-align:center; width: 20%; margin-left: 1em;" min="0"/> exclusions;
                    Total Hexes: {{ritualModifier.hexes}}
                    {{/if}}

                    {{#if (eq ritualModifier.modifier "modifier") }}
                    <select name="system.ritualModifier.{{id}}.effect.scope">
                        {{selectOptions ../ritualScope selected=ritualModifier.effect.scope}}
                    </select>
                    <input type="number" name="system.ritualModifier.{{id}}.effect.modifier" value="{{ritualModifier.effect.modifier}}" style="text-align:center; width: 20%; margin-left: 10%;"/>
                    {{/if}}

                    {{#if (eq ritualModifier.modifier "damage") }}
                    <div style="height: 27px">
                        <label>Damage: </label>
                        <input type="number" name="system.ritualModifier.{{id}}.effect.dice" value="{{ritualModifier.effect.dice}}" style="text-align:center; width: 20%;"/>
                        d6 + <input type="number" name="system.ritualModifier.{{id}}.effect.adds" value="{{ritualModifier.effect.adds}}" style="text-align:center; width: 20%;"/>
                        <select name="system.ritualModifier.{{id}}.effect.woundMod">
                            {{selectOptions ../woundCodes selected=ritualModifier.effect.woundMod}}
                        </select>
                    </div>

                    <div style="height: 27px">
                        <label for="external">External</label><input id="external" type="checkbox" name="system.ritualModifier.{{id}}.effect.external" {{checked ritualModifier.effect.external}} data-dtype="Boolean"/>
                    </div>
                    {{#if ritualModifier.effect.external }}
                    <div style="height: 27px">
                        <label for="explosive">Explosive</label><input id="explosive" type="checkbox" name="system.ritualModifier.{{id}}.effect.explosive" {{checked ritualModifier.effect.explosive}} data-dtype="Boolean"/>
                    </div>
                    <div style="height: 27px">
                        <label for="enhancementsOn">Total Enhancements</label><input id="enhancementsOn" type="checkbox" name="system.ritualModifier.{{id}}.effect.enhancementsOn" {{checked ritualModifier.effect.enhancementsOn}} data-dtype="Boolean"/>
                        {{#if ritualModifier.effect.enhancementsOn }}
                        <input type="number" name="system.ritualModifier.{{id}}.effect.enhancements" value="{{ritualModifier.effect.enhancements}}" style="text-align:center; width: 10%;"/>
                        <input type="text" name="system.ritualModifier.{{id}}.effect.enhancementNotes" value="{{ritualModifier.effect.enhancementNotes}}" style="width: 50%;" placeholder="Enhancement Notes"/>
                        {{/if}}
                    </div>
                    <div style="height: 27px">
                        <label for="limitationsOn">Total Limitations</label><input id="limitationsOn" type="checkbox" name="system.ritualModifier.{{id}}.effect.limitationsOn" {{checked ritualModifier.effect.limitationsOn}} data-dtype="Boolean"/>
                        {{#if ritualModifier.effect.limitationsOn }}
                        <input type="number" name="system.ritualModifier.{{id}}.effect.limitations" value="{{ritualModifier.effect.limitations}}" style="text-align:center; width: 10%;"/>
                        <input type="text" name="system.ritualModifier.{{id}}.effect.limitationNotes" value="{{ritualModifier.effect.limitationNotes}}" style="width: 50%;" placeholder="Limitation Notes"/>
                        {{/if}}
                    </div>
                    {{/if}}
                    {{/if}}

                    {{#if (eq ritualModifier.modifier "duration") }}
                    <select name="system.ritualModifier.{{id}}.effect.durationUnits">
                        {{selectOptions ../ritualDurationUnits selected=ritualModifier.effect.durationUnits}}
                    </select>
                    <input type="number" name="system.ritualModifier.{{id}}.effect.durationQty" value="{{ritualModifier.effect.durationQty}}" style="text-align:center; width: 20%;"/>
                    {{/if}}

                    {{#if (or (eq ritualModifier.modifier "energy") (eq ritualModifier.modifier "meta")) }}
                    <input type="number" name="system.ritualModifier.{{id}}.effect.extraEnergy" value="{{ritualModifier.effect.extraEnergy}}" style="text-align:center; width: 90%; margin: unset" />
                    {{/if}}

                    {{#if (eq ritualModifier.modifier "healing") }}
                    <div style="height: 27px">
                        <label>Healing: </label>
                        <input type="number" name="system.ritualModifier.{{id}}.effect.dice" value="{{ritualModifier.effect.dice}}" style="text-align:center; width: 20%;"/>
                        d6 + <input type="number" name="system.ritualModifier.{{id}}.effect.adds" value="{{ritualModifier.effect.adds}}" style="text-align:center; width: 20%;"/>
                        <select name="system.ritualModifier.{{id}}.effect.resource">
                            {{selectOptions ../resources selected=ritualModifier.effect.resource}}
                        </select>
                    </div>
                    {{/if}}

                    {{#if (eq ritualModifier.modifier "range") }}
                    {{#if (or (eq ritualModifier.effect.rangeType "normal")  (eq ritualModifier.effect.rangeType "info") ) }}
                    <input type="number" name="system.ritualModifier.{{id}}.effect.range" value="{{ritualModifier.effect.range}}" style="text-align:center; width: 20%; margin-left: 10%;" /> yards
                    {{/if}}
                    {{#if (eq ritualModifier.effect.rangeType "time") }}
                    <input type="number" name="system.ritualModifier.{{id}}.effect.range" value="{{ritualModifier.effect.range}}" style="text-align:center; width: 20%; margin-left: 10%;" /> days
                    {{/if}}
                    {{#if (eq ritualModifier.effect.rangeType "dim") }}
                    <input type="number" name="system.ritualModifier.{{id}}.effect.range" value="{{ritualModifier.effect.range}}" style="text-align:center; width: 20%; margin-left: 10%;" /> dimensions crossed
                    {{/if}}
                    <select name="system.ritualModifier.{{id}}.effect.rangeType">
                        {{selectOptions ../ritualRangeTypes selected=ritualModifier.effect.rangeType}}
                    </select>
                    {{/if}}

                    {{#if (eq ritualModifier.modifier "speed") }}
                    <input type="number" name="system.ritualModifier.{{id}}.effect.speed" value="{{ritualModifier.effect.speed}}" style="text-align:center; width: 20%; margin-left: 10%;" /> yards per second
                    {{/if}}

                    {{#if (eq ritualModifier.modifier "weight") }}
                    <input type="number" name="system.ritualModifier.{{id}}.effect.weight" value="{{ritualModifier.effect.weight}}" style="text-align:center; width: 50%; margin-left: 10%;" /> lbs
                    {{/if}}

                    {{#if (eq ritualModifier.modifier "trappings") }}
                    <input type="number" name="system.ritualModifier.{{id}}.effect.trappings" value="{{ritualModifier.effect.trappings}}" style="text-align:center; width: 50%; margin-left: 10%;" /> % discount
                    {{/if}}

                    {{#if (eq ritualModifier.modifier "crafting") }}
                    Item Cost: <input type="number" name="system.ritualModifier.{{id}}.effect.crafting" value="{{ritualModifier.effect.crafting}}" style="text-align:center; width: 50%;" /> $
                    <br>Crafting Penalty: {{ritualModifier.effect.craftingPenalty}}
                    {{/if}}

                    {{#if (eq ritualModifier.modifier "gmCrafting") }}
                    Modifier: <input type="number" name="system.ritualModifier.{{id}}.effect.craftingPenalty" value="{{ritualModifier.effect.craftingPenalty}}" style="text-align:center; width: 50%; margin-left: 10%;" />
                    {{/if}}

                </td>
                <td style="text-align: center">{{ritualModifier.cost}}</td>
                <td><input type="text" placeholder="Notes" name="system.ritualModifier.{{id}}.notes" value="{{ritualModifier.notes}}" title="{{ritualModifier.notes}}" style="text-align:left; margin: unset" data-dtype="String"/></td>
                <td style="text-align: right;"><a class="ritualModifier-delete" id="ritual{{id}}" title="Delete Item"><i class="fas fa-trash"></i></a></td>
            </tr>
            {{/each}}
        </table>
    </div>
    {{/if}}

    {{!-- Sheet Tab Navigation --}}
    <nav id="tabselect" class="sheet-tabs tabs" data-group="primary">
        <div class="header">
            <a class="item" data-tab="notes">Notes</a>
        </div>
        <div class="header">
            <a class="item" data-tab="melee">Melee</a>
        </div>
        <div class="header">
            <a class="item" data-tab="ranged">Ranged</a>
        </div>
        <div class="header">
            <a class="item" data-tab="affliction">Affliction</a>
        </div>
        {{#unless (eq item.type "Rollable")}}{{!-- Skills don't get to have armour --}}
        <div class="header">
            <a class="item" data-tab="armour">Armour</a>
        </div>
        {{/unless}}
    </nav>

    {{!-- Sheet Body --}}
    <section class="sheet-body">

        {{!-- Note Tab --}}
        <div class="tab stats" data-tab="notes" data-group="primary">
            <h3 class="bold">Detailed Notes</h3>
            <div class="tab">
                <textarea style="height: 100%; resize: none" name="system.notes">{{{item.system.notes}}}</textarea>
            </div>
        </div>

        {{!-- Melee Tab --}}
        <div class="tab stats" data-tab="melee" data-group="primary">
            <div style="text-align: right">
                <input type='button' style="text-align: right;" class="addRow" value='Add Melee Attack'/>
            </div>
            <div class="tab">
                <table>
                    <tr class="attack-table-header">
                        <th class="attack-column melee-id attack-shrink-column">ID</th>
                        <th class="attack-column attack-shrink-column">Name</th>
                        <th class="attack-column attack-shrink-column">Lv</th>
                        <th class="attack-column attack-shrink-column">Skill Name / Mod</th>
                        <th class="attack-column" style="width: 4.3em;">Parry - Type</th>
                        <th class="attack-column attack-shrink-column">Block</th>
                        <th class="attack-column attack-shrink-column">Damage</th>
                        <th class="attack-column attack-shrink-column">Type</th>
                        <th class="attack-column attack-shrink-column">AD</th>
                        <th class="attack-column attack-shrink-column">Reach</th>
                        <th class="attack-column attack-shrink-column">Area</th>
                        <th class="attack-column attack-shrink-column">ST</th>
                        <th class="attack-column">Flags</th>
                        <th class="attack-column attack-shrink-column"></th>
                    </tr>
                    {{#each item.system.melee as |melee id|}}
                    <tr class="equipment-entry">
                        <td class="resource-label melee-id">{{id}}</td>
                        <td><input type="text" name="system.melee.{{id}}.name" value="{{name}}" title="{{name}}" class="attack-name-input"/></td>
                        <td class="resource-label">
                            <div style="width: 2em">
                                {{melee.level}}
                            </div>
                        </td>
                        <td>
                            <div style="display: flex; flex-direction: row;">
                                <input type="text" name="system.melee.{{id}}.skill" value="{{melee.skill}}" title="{{melee.skill}}" class="attack-skill-input"/>/
                                <input type="text" name="system.melee.{{id}}.skillMod" value="{{melee.skillMod}}" data-dtype="Number" class="attack-two-digit-input"/>
                            </div>
                        </td>
                        <td>
                            <input type="text" name="system.melee.{{id}}.parryMod" value="{{melee.parryMod}}" class="attack-two-digit-input"/>
                            <input type="text" name="system.melee.{{id}}.parryType" value="{{melee.parryType}}" class="attack-two-digit-input"/>
                        </td>
                        <td class="melee-block">
                            <input type="text" name="system.melee.{{id}}.blockMod" value="{{melee.blockMod}}" class="attack-two-digit-input"/>
                        </td>
                        <td><input type="text" name="system.melee.{{id}}.damageInput" value="{{melee.damageInput}}" title="{{melee.damageInput}}" class="attack-damage-input"/></td>
                        <td>
                        <span class="tooltip">
                            <input type="text" name="system.melee.{{id}}.damageType" value="{{melee.damageType}}" title="{{melee.damageType}}" style="text-align:left; width: 7em" />
                            <span class="tooltiptext" style="margin-left: -200px">
                                <div>
                                    <span style="text-decoration: underline">Valid entries are:</span><br>
                                    burn: Burning<br>
                                    cor: Corrosion<br>
                                    cr: Crushing<br>
                                    cut: Cutting<br>
                                    fat: Fatigue<br>
                                    imp: Impaling<br>
                                    pi-: Small Piercing<br>
                                    pi: Piercing<br>
                                    pi+: Large Piercing<br>
                                    pi++: Huge Piercing<br>
                                    tox: Toxic<br>
                                    tbb: Tight Beam Burning<br>
                                    dam: Untyped<br>
                                    <span style="text-decoration: underline">Valid modifiers are:</span><br>
                                    dbk: Double Knockback<br>
                                    dbt: Double Blunt Trauma<br>
                                    nw: No Wounding<br>
                                    la: Large Area Injury<br>
                                </div>
                            </span>
                        </span>
                        </td>
                        <td class="melee-ad">
                        <span class="tooltip">
                            <input type="text" name="system.melee.{{id}}.armourDivisor" value="{{melee.armourDivisor}}" title="{{melee.armourDivisor}}" class="attack-two-digit-input" />
                            <span class="tooltiptext" style="margin-left: -200px">
                                <div>
                                    Default is 1<br>
                                    0 makes effective armour infinite<br>
                                    Using the words 'ignore' or 'cosmic' allows the attack to ignore armour<br>
                                    Setting this to 'I' will also ignore armour
                                </div>
                            </span>
                        </span>
                        </td>
                        <td class="melee-reach"><input type="text" name="system.melee.{{id}}.reach" value="{{melee.reach}}" title="{{melee.reach}}" style="text-align:left; width: 3em;" /></td>
                        <td class="resource-label">
                            <select name="system.melee.{{id}}.area" style="width: 5em">
                                {{selectOptions ../areaTypes selected=melee.area}}
                            </select>
                            {{#if (eq melee.area "area")}}
                            <input type="number" name="system.melee.{{id}}.areaRadius" value="{{melee.areaRadius}}" data-dtype="Number" class="attack-two-digit-input"/>
                            {{else if (eq melee.area "ex")}}
                            <input type="number" name="system.melee.{{id}}.exDivisor" value="{{melee.exDivisor}}" placeholder="3" data-dtype="Number" class="attack-one-digit-input"/>
                            {{/if}}
                        </td>
                        <td class="melee-st"><input type="text" name="system.melee.{{id}}.st" value="{{melee.st}}" class="attack-three-digit-input"/></td>
                        <td>
                            <span class="tooltip">
                                <input type="text" name="system.melee.{{id}}.flags" value="{{melee.flags}}" title="{{melee.flags}}" style="text-align:left;" />
                                <span class="tooltiptext" style="margin-left: -200px">
                                    <div>
                                        <span style="text-decoration: underline">Valid entries are:</span><br>
                                        una: Unarmed (Vulnerable to damage following a failed parry)<br>
                                        sw: Swing (Should be treated as a swing)<br>
                                        agp: Aggressive Parry<br>
                                        kik: Kick<br>
                                        gui: Guided<br>
                                        hom: Homing<br>
                                        short: Short Range (-1/yard)<br>
                                        long: Long Range (Long Distance Modifiers)<br>
                                        staff: The character's staff reduces range penalties<br>
                                        va#: Variable Scope (Replace # with Acc bonus)<br>
                                        bomba: Bombardment, uses attack's base skill<br>
                                        bomb#: Bombardment, the number as the skill<br>
                                        collateral: Collateral hits from a high rof attack.<br>
                                        yscatter: If the attack normally wouldn't scatter, it does.<br>
                                        nscatter: If the attack would normally scatter, it doesn't.<br>
                                        ytargethex: If the attack normally wouldn't get +4 for targeting a hex, it does.<br>
                                        ntargethex: If the attack would normally get +4 for targeting a hex, it doesn't.<br>
                                        diss: Dissipation for Area attacks<br>
                                    </div>
                                </span>
                            </span>
                        </td>
                        <td><a class="attack-delete" id="meleee{{id}}" title="Delete Item"><i class="fas fa-trash"></i></a></td>
                    </tr>
                    {{/each}}
                </table>
            </div>
        </div>

        {{!-- Ranged Tab --}}
        <div class="tab stats" data-tab="ranged" data-group="primary">
            <div style="text-align: right">
                <input type='button' style="text-align: right;" class="addRangedRow" value='Add Ranged Attack'/>
            </div>
            <div class="tab">
                <table>
                    <tr class="attack-table-header">
                        <th class="attack-column melee-id attack-shrink-column">ID</th>
                        <th class="attack-column attack-shrink-column">Name</th>
                        <th class="attack-column attack-shrink-column">Lv</th>
                        <th class="attack-column attack-shrink-column">Skill Name / Mod</th>
                        <th class="attack-column attack-shrink-column">Acc</th>
                        <th class="attack-column attack-shrink-column">Damage</th>
                        <th class="attack-column attack-shrink-column">Type</th>
                        <th class="attack-column attack-shrink-column">AD</th>
                        <th class="attack-column attack-shrink-column">Range</th>
                        <th class="attack-column attack-shrink-column">Area</th>
                        <th class="attack-column attack-shrink-column">Rof</th>
                        <th class="attack-column attack-shrink-column">Shots</th>
                        <th class="attack-column attack-shrink-column">Bulk</th>
                        <th class="attack-column attack-shrink-column">Rcl</th>
                        <th class="attack-column attack-shrink-column">ST</th>
                        <th class="attack-column attack-shrink-column">Malf</th>
                        <th class="attack-column">Flags</th>
                        <th class="attack-column attack-shrink-column"></th>
                    </tr>
                    {{#each item.system.ranged as |ranged id|}}
                    <tr class="equipment-entry">
                        <td class="resource-label melee-id">{{id}}</td>
                        <td><input type="text" name="system.ranged.{{id}}.name" value="{{name}}" title="{{name}}" class="attack-name-input"/></td>
                        <td class="resource-label">
                            <div style="width: 2em">
                                {{ranged.level}}
                            </div>
                        </td>
                        <td>
                            <div style="display: flex; flex-direction: row;">
                                <input type="text" name="system.ranged.{{id}}.skill" value="{{ranged.skill}}" title="{{ranged.skill}}" class="attack-skill-input"/>/
                                <input type="text" name="system.ranged.{{id}}.skillMod" value="{{ranged.skillMod}}" data-dtype="Number" class="attack-two-digit-input"/>
                            </div>
                        </td>
                        <td class="ranged-acc">
                            <input type="text" name="system.ranged.{{id}}.acc" value="{{ranged.acc}}" data-dtype="Number"/>+<input type="text" name="system.ranged.{{id}}.scopeAcc" value="{{ranged.scopeAcc}}" data-dtype="Number"/>
                        </td>
                        <td><input type="text" name="system.ranged.{{id}}.damageInput" value="{{ranged.damageInput}}" title="{{ranged.damageInput}}" class="attack-damage-input"/></td>
                        <td>
                            <span class="tooltip">
                                <input type="text" name="system.ranged.{{id}}.damageType" value="{{ranged.damageType}}" title="{{ranged.damageType}}" style="text-align:left; width: 7em" />
                                <span class="tooltiptext" style="margin-left: -200px">
                                    <div>
                                    <span style="text-decoration: underline">Valid entries are:</span><br>
                                    burn: Burning<br>
                                    cor: Corrosion<br>
                                    cr: Crushing<br>
                                    cut: Cutting<br>
                                    fat: Fatigue<br>
                                    imp: Impaling<br>
                                    pi-: Small Piercing<br>
                                    pi: Piercing<br>
                                    pi+: Large Piercing<br>
                                    pi++: Huge Piercing<br>
                                    tox: Toxic<br>
                                    tbb: Tight Beam Burning<br>
                                    dam: Untyped<br>
                                    <span style="text-decoration: underline">Valid modifiers are:</span><br>
                                    dbk: Double Knockback<br>
                                    dbt: Double Blunt Trauma<br>
                                    nw: No Wounding<br>
                                    la: Large Area Injury<br>
                                </div>
                                </span>
                            </span>
                        </td>
                        <td class="melee-ad">
                            <span class="tooltip">
                                <input type="text" name="system.ranged.{{id}}.armourDivisor" value="{{ranged.armourDivisor}}" title="{{ranged.armourDivisor}}" class="attack-two-digit-input" />
                                <span class="tooltiptext" style="margin-left: -200px">
                                    <div>
                                        Default is 1<br>
                                        0 makes effective armour infinite<br>
                                        Using the words 'ignore' or 'cosmic' allows the attack to ignore armour<br>
                                        Setting this to 'I' will also ignore armour
                                    </div>
                                </span>
                            </span>
                        </td>
                        <td>
                            <input type="text" name="system.ranged.{{id}}.halfRangeInput" value="{{ranged.halfRangeInput}}" title="{{ranged.halfRangeInput}}" class="attack-three-digit-input" placeholder="1/2 D" />
                            <span style="font-weight: bold">/</span>
                            <input type="text" name="system.ranged.{{id}}.maxRangeInput" value="{{ranged.maxRangeInput}}" title="{{ranged.maxRangeInput}}" style="text-align:center; width: 4em" placeholder="Max" />
                        </td>
                        <td class="resource-label">
                            <select name="system.ranged.{{id}}.area" style="width: 5em">
                                {{selectOptions ../areaTypes selected=ranged.area}}
                            </select>
                            {{#if (eq ranged.area "area")}}
                            <input type="number" name="system.ranged.{{id}}.areaRadius" value="{{ranged.areaRadius}}" data-dtype="Number" class="attack-two-digit-input"/>
                            {{else if (eq ranged.area "ex")}}
                            <input type="number" name="system.ranged.{{id}}.exDivisor" value="{{ranged.exDivisor}}" placeholder="3" data-dtype="Number" style="width: 1em;"/>
                            {{/if}}
                        </td>
                        <td><input type="text" name="system.ranged.{{id}}.rof" value="{{ranged.rof}}" title="{{ranged.rof}}" class="attack-two-digit-input"/></td>
                        <td><input type="text" name="system.ranged.{{id}}.shots" value="{{ranged.shots}}" title="{{ranged.shots}}" class="attack-shots-input"/></td>
                        <td><input type="text" name="system.ranged.{{id}}.bulk" value="{{ranged.bulk}}" title="{{ranged.bulk}}" class="attack-two-digit-input"/></td>
                        <td><input type="text" name="system.ranged.{{id}}.rcl" value="{{ranged.rcl}}" title="{{ranged.rcl}}" class="attack-two-digit-input"/></td>
                        <td class="melee-st"><input type="text" name="system.ranged.{{id}}.st" value="{{ranged.st}}" class="attack-three-digit-input"/></td>
                        <td><input type="text" name="system.ranged.{{id}}.malf" value="{{ranged.malf}}" class="attack-three-digit-input"/></td>
                        <td>
                            <span class="tooltip">
                                <input type="text" name="system.ranged.{{id}}.flags" value="{{ranged.flags}}" title="{{ranged.flags}}" style="text-align:left;" />
                                <span class="tooltiptext" style="margin-left: -200px">
                                    <div>
                                        <span style="text-decoration: underline">Valid entries are:</span><br>
                                        una: Unarmed (Vulnerable to damage following a failed parry)<br>
                                        sw: Swing (Should be treated as a swing)<br>
                                        agp: Aggressive Parry<br>
                                        kik: Kick<br>
                                        gui: Guided<br>
                                        hom: Homing<br>
                                        short: Short Range (-1/yard)<br>
                                        long: Long Range (Long Distance Modifiers)<br>
                                        staff: The character's staff reduces range penalties<br>
                                        va#: Variable Scope (Replace # with Acc bonus)<br>
                                        bomba: Bombardment, uses attack's base skill<br>
                                        bomb#: Bombardment, the number as the skill<br>
                                        collateral: Collateral hits from a high rof attack.<br>
                                        yscatter: If the attack normally wouldn't scatter, it does.<br>
                                        nscatter: If the attack would normally scatter, it doesn't.<br>
                                        ytargethex: If the attack normally wouldn't get +4 for targeting a hex, it does.<br>
                                        ntargethex: If the attack would normally get +4 for targeting a hex, it doesn't.<br>
                                        diss: Dissipation for Area attacks<br>
                                    </div>
                                </span>
                            </span>
                        </td>
                        <td><a class="ranged-delete" id="ranged{{id}}" title="Delete Item"><i class="fas fa-trash"></i></a></td>
                    </tr>
                    {{/each}}
                </table>
            </div>
        </div>

        {{!-- Affliction Tab --}}
        <div class="tab stats" data-tab="affliction" data-group="primary">
            <div style="text-align: right">
                <input type='button' style="text-align: right;" class="addAfflictionRow" value='Add Affliction'/>
            </div>
            <div class="tab">
                <table>
                    <tr class="attack-table-header">
                        <th class="attack-column attack-shrink-column">Name</th>
                        <th class="attack-column attack-shrink-column">Lv</th>
                        <th class="attack-column attack-shrink-column">Skill Name / Mod</th>
                        <th class="attack-column attack-shrink-column">Damage</th>
                        <th class="attack-column attack-shrink-column">Type</th>
                        <th class="attack-column attack-shrink-column">AD</th>
                        <th class="attack-column">Effect Description</th>
                        <th class="attack-column attack-shrink-column">Range Penalties</th>
                        <th class="attack-column attack-shrink-column">Area</th>
                        <th class="attack-column attack-shrink-column">
                            <span class="tooltip">
                                Resist With
                                <span class="tooltiptext" style="margin-left: -100px;">For both Quick Contests and Resistance Rolls.<br>
                                    Penalty applies to the target's roll in either case.</span>
                            </span>
                        </th>
                        <th class="attack-column attack-shrink-column">
                            <span class="tooltip">
                                Rule Of
                                <span class="tooltiptext" style="margin-left: -100px;">This should be 13 for Fright and 16 for everything else except in special cases.</span>
                            </span>
                        </th>
                        <th class="attack-column">Flags</th>
                        <th class="attack-column attack-shrink-column"></th>
                    </tr>
                    {{#each item.system.affliction as |affliction id|}}
                    <tr class="equipment-entry">
                        <td><input type="text" name="system.affliction.{{id}}.name" value="{{name}}" title="{{name}}" class="attack-name-input"/></td>
                        <td class="resource-label">
                            <div style="width: 2em">
                                {{affliction.level}}
                            </div>
                        </td>
                        <td>
                            <div style="display: flex; flex-direction: row;">
                                <input type="text" name="system.affliction.{{id}}.skill" value="{{affliction.skill}}" title="{{affliction.skill}}"  class="attack-skill-input"/>/
                                <input type="text" name="system.affliction.{{id}}.skillMod" value="{{affliction.skillMod}}" data-dtype="Number" class="attack-two-digit-input"/>
                            </div>
                        </td>
                        <td><input type="text" name="system.affliction.{{id}}.damageInput" value="{{affliction.damageInput}}" title="{{affliction.damageInput}}" class="attack-damage-input"/></td>
                        <td>
                            <span class="tooltip">
                                <input type="text" name="system.affliction.{{id}}.damageType" value="{{affliction.damageType}}" title="{{affliction.damageType}}" style="text-align:left; width: 7em;" />
                                <span class="tooltiptext" style="margin-left: -200px">
                                    <div>
                                        <span style="text-decoration: underline">Valid entries are:</span><br>
                                        burn: Burning<br>
                                        cor: Corrosion<br>
                                        cr: Crushing<br>
                                        cut: Cutting<br>
                                        fat: Fatigue<br>
                                        imp: Impaling<br>
                                        pi-: Small Piercing<br>
                                        pi: Piercing<br>
                                        pi+: Large Piercing<br>
                                        pi++: Huge Piercing<br>
                                        tox: Toxic<br>
                                        tbb: Tight Beam Burning<br>
                                        dam: Untyped<br>
                                        <span style="text-decoration: underline">Valid modifiers are:</span><br>
                                        dbk: Double Knockback<br>
                                        dbt: Double Blunt Trauma<br>
                                        nw: No Wounding<br>
                                        la: Large Area Injury<br>
                                    </div>
                                </span>
                            </span>
                        </td>
                        <td>
                            <span class="tooltip">
                                <input type="text" name="system.affliction.{{id}}.armourDivisor" value="{{affliction.armourDivisor}}" title="{{affliction.armourDivisor}}" class="attack-two-digit-input"/>
                                <span class="tooltiptext" style="margin-left: -200px">
                                    <div>
                                        Default is 1<br>
                                        0 makes effective armour infinite<br>
                                        Using the words 'ignore' or 'cosmic' allows the attack to ignore armour<br>
                                        Setting this to 'I' will also ignore armour
                                    </div>
                                </span>
                            </span>
                        </td>
                        <td><input type="text" name="system.affliction.{{id}}.desc" value="{{desc}}" title="{{desc}}" style="text-align:left;" /></td>
                        <td class="resource-label">
                            <select name="system.affliction.{{id}}.rangePenalties">
                                {{selectOptions ../rangeTypes selected=affliction.rangePenalties}}
                            </select>
                        </td>
                        <td class="resource-label">
                            <select name="system.affliction.{{id}}.area" style="width: 5em">
                                {{selectOptions ../areaTypes selected=affliction.area}}
                            </select>
                            {{#if (eq affliction.area "area")}}
                            <input type="number" name="system.affliction.{{id}}.areaRadius" value="{{affliction.areaRadius}}" data-dtype="Number" class="attack-two-digit-input"/>
                            {{else if (eq affliction.area "ex")}}
                            <input type="number" name="system.affliction.{{id}}.exDivisor" value="{{affliction.exDivisor}}" placeholder="3" data-dtype="Number" class="attack-one-digit-input"/>
                            {{/if}}
                        </td>
                        <td>
                            <div class="attack-resistance-container">
                                <select name="system.affliction.{{id}}.resistanceType" class="attack-resistance-type-input">
                                    {{selectOptions ../resistanceTypes selected=affliction.resistanceType}}
                                </select>
                                <select name="system.affliction.{{id}}.resistanceRoll" class="attack-resistance-attr-input">
                                    {{selectOptions ../resistanceAttr selected=affliction.resistanceRoll}}
                                </select>
                                <input type="text" placeholder="-0" name="system.affliction.{{id}}.resistanceRollPenalty" value="{{affliction.resistanceRollPenalty}}" title="{{affliction.resistanceRollPenalty}}" class="attack-resistance-roll-penalty-input"/>
                            </div>
                        </td>
                        <td><input type="text" name="system.affliction.{{id}}.ruleOf" value="{{affliction.ruleOf}}" title="{{affliction.ruleOf}}" class="attack-two-digit-input"/></td>
                        <td>
                            <span class="tooltip">
                                <input type="text" name="system.affliction.{{id}}.flags" value="{{affliction.flags}}" title="{{affliction.flags}}" style="text-align:left;" />
                                <span class="tooltiptext" style="margin-left: -200px">
                                    <div>
                                        <span style="text-decoration: underline">Valid entries are:</span><br>
                                        una: Unarmed (Vulnerable to damage following a failed parry)<br>
                                        sw: Swing (Should be treated as a swing)<br>
                                        agp: Aggressive Parry<br>
                                        kik: Kick<br>
                                        gui: Guided<br>
                                        hom: Homing<br>
                                        short: Short Range (-1/yard)<br>
                                        long: Long Range (Long Distance Modifiers)<br>
                                        staff: The character's staff reduces range penalties<br>
                                        va#: Variable Scope (Replace # with Acc bonus)<br>
                                        bomba: Bombardment, uses attack's base skill<br>
                                        bomb#: Bombardment, the number as the skill<br>
                                        collateral: Collateral hits from a high rof attack.<br>
                                        yscatter: If the attack normally wouldn't scatter, it does.<br>
                                        nscatter: If the attack would normally scatter, it doesn't.<br>
                                        ytargethex: If the attack normally wouldn't get +4 for targeting a hex, it does.<br>
                                        ntargethex: If the attack would normally get +4 for targeting a hex, it doesn't.<br>
                                        diss: Dissipation for Area attacks<br>
                                    </div>
                                </span>
                            </span>
                        </td>
                        <td><a class="affliction-delete" id="affliction{{id}}" title="Delete Item"><i class="fas fa-trash"></i></a></td>
                    </tr>
                    {{/each}}
                </table>
            </div>
        </div>

        {{!-- Armour Tab --}}
        {{#unless (eq item.type "Rollable")}}{{!-- Skills don't get to have armour --}}
        <div class="tab stats" data-tab="armour" data-group="primary">
            <div class="tab">
                <span>
                    <label>Body Type:</label>
                    <select name="system.armour.bodyType.name" class="bodyType">
                        {{selectOptions bodyTypes selected=item.system.armour.bodyType.name}}
                    </select>
                </span>
                {{#if (eq item.system.armour.bodyType.name "") }}
                <br>Please only set body type if this equipment applies DR. Otherwise the formula that adds up armour will check this for DR values. With enough items on your sheet it will eventually degrade performance.
                {{else}}
                <span class="tooltip">
                    <label>Layer:</label>
                    <input type="number" style="width: unset;" name="system.armour.layer" value="{{item.system.armour.layer}}" data-dtype="Number" />
                    <span class="tooltiptext">
                        <div>
                            Higher layer numbers are placed above lower layer numbers.<br>
                            - is closest to the body.<br>
                            + is furthest from the body.<br>
                            You can enter any real number.<br>
                            Ties won't cause errors but should be avoided.<br>
                        </div>
					</span>
                </span>
                {{/if}}
                <table class="dr-entry-table">
                    {{#unless (eq item.system.armour.bodyType.name "") }}
                    <tr class="hit-locations">
                        <td class="dr-header"></td>
                        <td class="dr-header">Flex</td>
                        <td class="dr-damage-types">Hardness</td>
                        <td class="dr-damage-types">Burn</td>
                        <td class="dr-damage-types">Cor</td>
                        <td class="dr-damage-types">Cr</td>
                        <td class="dr-damage-types">Cut</td>
                        <td class="dr-damage-types">Fat</td>
                        <td class="dr-damage-types">Imp</td>
                        <td class="dr-damage-types">Pi</td>
                        <td class="dr-damage-types">Tox</td>
                    </tr>
                    {{/unless}}
                    {{#each item.system.armour.bodyType.body as |bodyPart partId|}}<!--Loop through the body parts-->
                    <tr class="hit-locations master-location">
                        <th colspan="11">
                            <div>{{bodyPart.label}}</div>
                            <div>
                                <a class="locationDRUp" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-up"></i></a>
                                <a class="locationDRDown" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-down"></i></a>
                            </div>
                        </th>
                    <tr>
                        <td colspan="3"></td>
                        <td>
                            <div class="dr-damage-type-buttons">
                                <a class="burnDRUp" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-up"></i></a>
                                <a class="burnDRDown" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-down"></i></a>
                            </div>
                        </td>
                        <td>
                            <div class="dr-damage-type-buttons">
                                <a class="corDRUp" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-up"></i></a>
                                <a class="corDRDown" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-down"></i></a>
                            </div>
                        </td>
                        <td>
                            <div class="dr-damage-type-buttons">
                                <a class="crDRUp" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-up"></i></a>
                                <a class="crDRDown" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-down"></i></a>
                            </div>
                        </td>
                        <td>
                            <div class="dr-damage-type-buttons">
                                <a class="cutDRUp" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-up"></i></a>
                                <a class="cutDRDown" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-down"></i></a>
                            </div>
                        </td>
                        <td>
                            <div class="dr-damage-type-buttons">
                                <a class="fatDRUp" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-up"></i></a>
                                <a class="fatDRDown" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-down"></i></a>
                            </div>
                        </td>
                        <td>
                            <div class="dr-damage-type-buttons">
                                <a class="impDRUp" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-up"></i></a>
                                <a class="impDRDown" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-down"></i></a>
                            </div>
                        </td>
                        <td>
                            <div class="dr-damage-type-buttons">
                                <a class="piDRUp" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-up"></i></a>
                                <a class="piDRDown" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-down"></i></a>
                            </div>
                        </td>
                        <td>
                            <div class="dr-damage-type-buttons">
                                <a class="toxDRUp" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-up"></i></a>
                                <a class="toxDRDown" id="item.system.armour.bodyType.body.{{partId}}" title="Shift x10, Ctrl x5, Alt x2"><i class="fas fa-arrow-down"></i></a>
                            </div>
                        </td>
                    </tr>
                    </tr>
                    {{#if bodyPart.subLocation}}<!--Check to see if there are sublocations and display them-->
                    {{#each bodyPart.subLocation as |subLocation locationId|}}<!--Loop through the sublocations-->
                    <tr class="hit-locations">
                        <td class="dr-row">
                            <div>{{subLocation.label}}</div>
                            <div>
                                <a class="subLocationDRUp" id="item.system.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}" title="Sublocation DR Up"><i class="fas fa-arrow-up"></i></a>
                                <a class="subLocationDRDown" id="item.system.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}" title="Sublocation DR Down"><i class="fas fa-arrow-down"></i></a>
                            </div>
                        </td>
                        <td class="dr-row">
                            <input type="checkbox" name="system.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}.flexible" {{checked subLocation.flexible}} data-dtype="Boolean" style="width: 100%;"/>
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}.drHardening" value="{{subLocation.drHardening}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}.drBurn" value="{{subLocation.drBurn}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}.drCor" value="{{subLocation.drCor}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}.drCr" value="{{subLocation.drCr}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}.drCut" value="{{subLocation.drCut}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}.drFat" value="{{subLocation.drFat}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}.drImp" value="{{subLocation.drImp}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}.drPi" value="{{subLocation.drPi}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.subLocation.{{locationId}}.drTox" value="{{subLocation.drTox}}" data-dtype="Number" />
                        </td>
                    </tr>
                    {{/each}}
                    {{else}}<!--Display details for parts without sublocations (Pretty much only the skull and brian)-->
                    <tr class="hit-locations">
                        <td class="dr-row">{{bodyPart.label}}</td>
                        <td class="dr-row">
                            <input type="checkbox" name="system.armour.bodyType.body.{{partId}}.flexible" {{checked bodyPart.flexible}} data-dtype="Boolean" style="width: 100%;"/>
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.drHardening" value="{{bodyPart.drHardening}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.drBurn" value="{{bodyPart.drBurn}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.drCor" value="{{bodyPart.drCor}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.drCr" value="{{bodyPart.drCr}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.drCut" value="{{bodyPart.drCut}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.drFat" value="{{bodyPart.drFat}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.drImp" value="{{bodyPart.drImp}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.drPi" value="{{bodyPart.drPi}}" data-dtype="Number" />
                        </td>
                        <td class="dr-row">
                            <input type="number" name="system.armour.bodyType.body.{{partId}}.drTox" value="{{bodyPart.drTox}}" data-dtype="Number" />
                        </td>
                    </tr>
                    {{/if}}
                    {{/each}}
                </table>
            </div>
        </div>
        {{/unless}}
    </section>
</form>
